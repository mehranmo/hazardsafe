{
    "name": "HazardSAFE HITL Workflow (Corrected)",
    "description": "Human-in-the-loop workflow: scenario -> compliance -> human approval -> provenance -> VC issuance -> output (approval) or rejection output.",
    "data": {
        "nodes": [
            {
                "id": "ChatInput-Scenario",
                "type": "ChatInput",
                "data": {
                    "type": "ChatInput",
                    "node": {
                        "template": {
                            "input_value": {
                                "type": "str",
                                "value": "{\"id\": \"SCN-DEMO-001\", \"material_class\": \"Class 7\", \"package_type\": \"Type B(U)\", \"ambient_temperature_c\": 25.0, \"transport_index\": 0.5}"
                            }
                        },
                        "description": "HazMat Scenario Input"
                    }
                },
                "position": {
                    "x": 0,
                    "y": 0
                }
            },
            {
                "id": "ComplianceAgent-Node",
                "type": "CustomComponent",
                "data": {
                    "node": {
                        "template": {
                            "_type": "Component",
                            "code": {
                                "value": "from langflow.custom import CustomComponent\nfrom src.agents.compliance_agent import HazardComplianceAgent\n\nclass ComplianceAgentComponent(CustomComponent):\n    display_name = \"Hazard Compliance Agent\"\n    description = \"Checks a HazMat scenario against regulations.\"\n\n    def build_config(self):\n        return {\n            \"scenario\": {\"display_name\": \"Scenario JSON\", \"field_type\": \"dict\"},\n            \"model_name\": {\"display_name\": \"Model Name\", \"value\": \"gemini-2.0-flash-exp\"}\n        }\n\n    def build(self, scenario: dict, model_name: str = \"gemini-2.0-flash-exp\") -> dict:\n        agent = HazardComplianceAgent(model_name=model_name)\n        result = agent.check_scenario(scenario)\n        return result"
                            }
                        }
                    }
                },
                "position": {
                    "x": 300,
                    "y": 0
                }
            },
            {
                "id": "ChatInput-HITL",
                "type": "ChatInput",
                "data": {
                    "type": "ChatInput",
                    "node": {
                        "template": {
                            "input_value": {
                                "type": "str",
                                "value": "Type 'yes' to approve or 'no' to reject"
                            }
                        },
                        "description": "HITL Approval"
                    }
                },
                "position": {
                    "x": 600,
                    "y": 0
                }
            },
            {
                "id": "ProvenanceAgent-Node",
                "type": "CustomComponent",
                "data": {
                    "node": {
                        "template": {
                            "_type": "Component",
                            "code": {
                                "value": "from langflow.custom import CustomComponent\nfrom src.agents.provenance_agent import HazardProvenanceAgent\n\nclass ProvenanceAgentComponent(CustomComponent):\n    display_name = \"Hazard Provenance Agent\"\n    description = \"Logs events to the immutable ledger.\"\n\n    def build_config(self):\n        return {\n            \"agent_id\": {\"display_name\": \"Source Agent ID\", \"field_type\": \"str\"},\n            \"event_type\": {\"display_name\": \"Event Type\", \"field_type\": \"str\"},\n            \"payload\": {\"display_name\": \"Event Payload\", \"field_type\": \"dict\"}\n        }\n\n    def build(self, agent_id: str, event_type: str, payload: dict) -> dict:\n        agent = HazardProvenanceAgent()\n        result = agent.log_event(event_type, agent_id, payload)\n        return result"
                            }
                        }
                    }
                },
                "position": {
                    "x": 900,
                    "y": 0
                }
            },
            {
                "id": "ReportAgent-Node",
                "type": "CustomComponent",
                "data": {
                    "node": {
                        "template": {
                            "_type": "Component",
                            "code": {
                                "value": "from langflow.custom import CustomComponent\nfrom src.agents.report_agent import ReportAgent\n\nclass ReportAgentComponent(CustomComponent):\n    display_name = \"Report & VC Agent\"\n    description = \"Issues a Verifiable Credential if compliant.\"\n\n    def build_config(self):\n        return {\n            \"scenario_id\": {\"display_name\": \"Scenario ID\", \"field_type\": \"str\"},\n            \"decision\": {\"display_name\": \"Compliance Decision\", \"field_type\": \"dict\"},\n            \"evidence_id\": {\"display_name\": \"Evidence ID\", \"field_type\": \"str\"}\n        }\n\n    def build(self, scenario_id: str, decision: dict, evidence_id: str) -> dict:\n        agent = ReportAgent()\n        vc = agent.issue_vc(scenario_id, decision, evidence_id)\n        return vc"
                            }
                        }
                    }
                },
                "position": {
                    "x": 1200,
                    "y": 0
                }
            },
            {
                "id": "ChatOutput-Final",
                "type": "ChatOutput",
                "data": {
                    "type": "ChatOutput",
                    "node": {
                        "description": "Final VC Output"
                    }
                },
                "position": {
                    "x": 1500,
                    "y": 0
                }
            }
        ],
        "edges": []
    }
}